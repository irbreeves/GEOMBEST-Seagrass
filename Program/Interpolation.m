function Interpolation(RSLR,RivInput,WidthDifference,Title)
% Interpolates between points of phase space to create plot

% Ian Reeves 12-April-2017


X = RSLR;
Y = RivInput;
Z = WidthDifference;

% Create matrix
Xs = unique(X);
Ys = unique(Y);
Xi = arrayfun( @(x) find(Xs==x), X );
Yi = arrayfun( @(y) find(Ys==y), Y );
Li = Yi + (Xi-1) * numel(Ys);
XYZ = nan(numel(Ys), numel(Xs));
XYZ( Li ) = Z;


% Create interpolant
[X,Y] = meshgrid(1:size(XYZ,2), 1:size(XYZ,1));
F = scatteredInterpolant(X(:), Y(:), XYZ(:), 'natural');

% Interpolate over a finer grid
[U,V] = meshgrid(linspace(1,size(XYZ,2),75), linspace(1,size(XYZ,1),75));

% Red/Blue
fig = figure('units','normalized','position',[.15, .1, .70, .80],'Colormap',...
        [0.290196090936661 0 0;0.337254911661148 0.0117647061124444 0.0117647061124444;0.384313732385635 0.0235294122248888 0.0235294122248888;0.431372582912445 0.0352941192686558 0.0352941192686558;0.478431403636932 0.0470588244497776 0.0470588244497776;0.52549022436142 0.0588235296308994 0.0588235296308994;0.568003594875336 0.0755793228745461 0.0755793228745461;0.610516965389252 0.092335119843483 0.092335119843483;0.653030335903168 0.109090909361839 0.109090909361839;0.695543706417084 0.125846698880196 0.125846698880196;0.738057076931 0.142602503299713 0.142602503299713;0.780570387840271 0.159358292818069 0.159358292818069;0.823083758354187 0.176114082336426 0.176114082336426;0.865597128868103 0.192869871854782 0.192869871854782;0.908110499382019 0.209625661373138 0.209625661373138;0.950623869895935 0.226381465792656 0.226381465792656;0.993137240409851 0.243137255311012 0.243137255311012;0.991764664649963 0.291764706373215 0.291764706373215;0.99039214849472 0.340392172336578 0.340392172336578;0.989019572734833 0.38901960849762 0.38901960849762;0.98764705657959 0.437647044658661 0.437647044658661;0.986274480819702 0.486274510622025 0.486274510622025;0.984901964664459 0.534901976585388 0.534901976585388;0.983529388904572 0.583529412746429 0.583529412746429;0.982156872749329 0.632156848907471 0.632156848907471;0.980784296989441 0.680784344673157 0.680784344673157;0.979411780834198 0.729411780834198 0.729411780834198;0.97803920507431 0.778039216995239 0.778039216995239;0.976666688919067 0.826666653156281 0.826666653156281;0.97529411315918 0.875294089317322 0.875294089317322;0.973921597003937 0.923921585083008 0.923921585083008;0.972549021244049 0.972549021244049 0.972549021244049;1 1 1;0.950326800346375 0.963398694992065 1;0.900653600692749 0.926797389984131 1;0.850980401039124 0.890196084976196 1;0.801307201385498 0.853594779968262 1;0.751634001731873 0.816993474960327 1;0.701960802078247 0.780392169952393 1;0.648529410362244 0.744607865810394 0.984803915023804;0.595098078250885 0.708823561668396 0.969607830047607;0.541666686534882 0.673039197921753 0.954411745071411;0.488235294818878 0.637254893779755 0.939215660095215;0.434803932905197 0.601470589637756 0.924019634723663;0.381372570991516 0.565686285495758 0.908823549747467;0.327941179275513 0.52990198135376 0.893627464771271;0.274509817361832 0.494117647409439 0.878431379795074;0.273057371377945 0.491706609725952 0.87599128484726;0.271604955196381 0.489295572042465 0.873551189899445;0.270152509212494 0.486884534358978 0.871111154556274;0.26870009303093 0.484473496675491 0.868671059608459;0.267247647047043 0.482062458992004 0.866230964660645;0.251512944698334 0.455942869186401 0.839796662330627;0.235778272151947 0.429823279380798 0.813362419605255;0.220043584704399 0.403703719377518 0.786928117275238;0.204308897256851 0.377584129571915 0.760493874549866;0.188574194908142 0.351464539766312 0.734059572219849;0.172839507460594 0.325344949960709 0.707625269889832;0.157104820013046 0.299225360155106 0.681191027164459;0.141370132565498 0.273105800151825 0.654756724834442;0.12563544511795 0.246986210346222 0.62832248210907;0.109900757670403 0.220866620540619 0.601888179779053;0.094166062772274 0.194747045636177 0.57545393705368;0.0784313753247261 0.168627455830574 0.549019634723663]);

%       [0.600000023841858 0.200000002980232 0;0.731045782566071 0.214379087090492 0.0810457542538643;0.862091481685638 0.228758171200752 0.162091508507729;0.993137240409851 0.243137255311012 0.243137255311012;0.990849673748016 0.324183017015457 0.324183017015457;0.988562107086182 0.405228763818741 0.405228763818741;0.986274480819702 0.486274510622025 0.486274510622025;0.983986914157867 0.567320287227631 0.567320287227631;0.981699347496033 0.648366034030914 0.648366034030914;0.979411780834198 0.729411780834198 0.729411780834198;0.977124154567719 0.810457527637482 0.810457527637482;0.974836587905884 0.891503274440765 0.891503274440765;0.972549021244049 0.972549021244049 0.972549021244049;0.947950065135956 0.955080211162567 0.975044548511505;0.923351168632507 0.937611401081085 0.977540135383606;0.898752212524414 0.920142590999603 0.980035662651062;0.874153316020966 0.902673780918121 0.982531189918518;0.849554359912872 0.885204970836639 0.985026717185974;0.824955463409424 0.867736220359802 0.987522304058075;0.800356507301331 0.85026741027832 0.990017831325531;0.775757610797882 0.832798600196838 0.992513358592987;0.751158654689789 0.815329790115356 0.995008885860443;0.72655975818634 0.797860980033875 0.997504472732544;0.701960802078247 0.780392169952393 1;0.669079959392548 0.75837105512619 0.990648567676544;0.636199116706848 0.736349940299988 0.981297135353088;0.603318274021149 0.714328825473785 0.971945703029633;0.570437431335449 0.692307710647583 0.962594270706177;0.53755658864975 0.670286595821381 0.953242838382721;0.50467574596405 0.648265480995178 0.943891406059265;0.471794873476028 0.626244366168976 0.934539973735809;0.438914030790329 0.604223251342773 0.925188541412354;0.40603318810463 0.582202136516571 0.915837109088898;0.37315234541893 0.560181021690369 0.906485676765442;0.340271502733231 0.538159906864166 0.897134244441986;0.307390660047531 0.516138792037964 0.88778281211853;0.274509817361832 0.494117647409439 0.878431379795074;0.267247647047043 0.482062458992004 0.866230964660645;0.259985476732254 0.47000727057457 0.85403048992157;0.252723336219788 0.457952082157135 0.84183007478714;0.245461165904999 0.445896863937378 0.82962965965271;0.23819899559021 0.433841675519943 0.817429184913635;0.230936825275421 0.421786487102509 0.805228769779205;0.223674669861794 0.409731298685074 0.793028354644775;0.216412499547005 0.397676110267639 0.780827879905701;0.209150344133377 0.385620921850204 0.768627464771271;0.201888173818588 0.37356573343277 0.756427049636841;0.194626003503799 0.361510545015335 0.744226574897766;0.187363848090172 0.349455326795578 0.732026159763336;0.180101677775383 0.337400138378143 0.719825744628906;0.172839507460594 0.325344949960709 0.707625269889832;0.165577352046967 0.313289761543274 0.695424854755402;0.158315181732178 0.301234573125839 0.683224439620972;0.15105302631855 0.289179384708405 0.671023964881897;0.143790856003761 0.27712419629097 0.658823549747467;0.136528685688972 0.265069007873535 0.646623134613037;0.129266530275345 0.253013789653778 0.634422659873962;0.122004359960556 0.240958616137505 0.622222244739532;0.114742197096348 0.228903412818909 0.610021829605103;0.10748003423214 0.216848224401474 0.597821354866028;0.100217871367931 0.204793035984039 0.585620939731598;0.0929557010531425 0.192737847566605 0.573420524597168;0.0856935381889343 0.180682644248009 0.561220049858093;0.0784313753247261 0.168627455830574 0.549019634723663]);

%     [0.509803950786591 0.0784313753247261 0.184313729405403;0.5404412150383 0.073529414832592 0.172794118523598;0.571078479290009 0.0686274543404579 0.161274507641792;0.601715683937073 0.0637254938483238 0.149754911661148;0.632352948188782 0.0588235333561897 0.138235300779343;0.662990212440491 0.0539215691387653 0.126715689897537;0.6936274766922 0.0490196086466312 0.115196079015732;0.724264740943909 0.0441176481544971 0.103676475584507;0.754902005195618 0.0392156876623631 0.0921568647027016;0.785539209842682 0.034313727170229 0.0806372538208961;0.816176474094391 0.0294117666780949 0.0691176503896713;0.8468137383461 0.0245098043233156 0.0575980395078659;0.877451002597809 0.0196078438311815 0.0460784323513508;0.908088266849518 0.0147058833390474 0.0345588251948357;0.938725471496582 0.00980392191559076 0.0230392161756754;0.969362735748291 0.00490196095779538 0.0115196080878377;1 0 0;0.997888386249542 0.0748114660382271 0.0748114660382271;0.995776772499084 0.149622932076454 0.149622932076454;0.993665158748627 0.224434390664101 0.224434390664101;0.991553544998169 0.299245864152908 0.299245864152908;0.989441931247711 0.374057322740555 0.374057322740555;0.987330317497253 0.448868781328201 0.448868781328201;0.985218703746796 0.52368026971817 0.52368026971817;0.983107089996338 0.598491728305817 0.598491728305817;0.98099547624588 0.673303186893463 0.673303186893463;0.978883862495422 0.74811464548111 0.74811464548111;0.976772248744965 0.822926104068756 0.822926104068756;0.974660634994507 0.897737562656403 0.897737562656403;0.972549021244049 0.972549021244049 0.972549021244049;0.930264294147491 0.930264294147491 0.973742544651031;0.887979567050934 0.887979567050934 0.974936068058014;0.845694780349731 0.845694780349731 0.976129591464996;0.803410053253174 0.803410053253174 0.977323114871979;0.761125326156616 0.761125326156616 0.978516638278961;0.718840599060059 0.718840599060059 0.979710161685944;0.676555812358856 0.676555812358856 0.980903685092926;0.634271085262299 0.634271085262299 0.982097208499908;0.591986358165741 0.591986358165741 0.983290731906891;0.549701631069183 0.549701631069183 0.984484255313873;0.507416903972626 0.507416903972626 0.985677778720856;0.465132147073746 0.465132147073746 0.986871242523193;0.422847390174866 0.422847390174866 0.988064765930176;0.380562663078308 0.380562663078308 0.989258289337158;0.338277906179428 0.338277906179428 0.990451812744141;0.29599317908287 0.29599317908287 0.991645336151123;0.253708451986313 0.253708451986313 0.992838859558105;0.211423695087433 0.211423695087433 0.994032382965088;0.169138953089714 0.169138953089714 0.99522590637207;0.126854225993156 0.126854225993156 0.996419429779053;0.084569476544857 0.084569476544857 0.997612953186035;0.0422847382724285 0.0422847382724285 0.998806476593018;0 0 1;0.0071301250718534 0.0153297688812017 0.959001779556274;0.0142602501437068 0.0306595377624035 0.918003559112549;0.0213903747498989 0.0459893047809601 0.877005338668823;0.0285205002874136 0.061319075524807 0.836007118225098;0.0356506258249283 0.0766488462686539 0.795008897781372;0.0427807494997978 0.0919786095619202 0.754010736942291;0.0499108768999577 0.107308380305767 0.713012516498566;0.0570410005748272 0.122638151049614 0.67201429605484;0.064171127974987 0.13796791434288 0.631016075611115;0.0713012516498566 0.153297692537308 0.590017855167389;0.0784313753247261 0.168627455830574 0.549019634723663]);

%     [0.509803950786591 0.0784313753247261 0.184313729405403;0.532085597515106 0.074866309762001 0.175935834646225;0.554367244243622 0.0713012516498566 0.167557939887047;0.576648890972137 0.0677361860871315 0.159180045127869;0.598930478096008 0.064171127974987 0.150802135467529;0.621212124824524 0.060606062412262 0.142424240708351;0.64349377155304 0.0570410005748272 0.134046345949173;0.665775418281555 0.0534759387373924 0.125668451189995;0.688057065010071 0.0499108768999577 0.117290556430817;0.710338711738586 0.0463458113372326 0.108912661671638;0.732620358467102 0.0427807494997978 0.10053475946188;0.754902005195618 0.0392156876623631 0.0921568647027016;0.777183592319489 0.0356506258249283 0.0837789699435234;0.799465239048004 0.0320855639874935 0.0754010677337646;0.82174688577652 0.0285205002874136 0.0670231729745865;0.844028532505035 0.0249554384499788 0.0586452782154083;0.866310179233551 0.0213903747498989 0.0502673797309399;0.888591825962067 0.0178253129124641 0.0418894849717617;0.910873472690582 0.0142602501437068 0.0335115864872932;0.933155059814453 0.0106951873749495 0.0251336898654699;0.955436706542969 0.0071301250718534 0.0167557932436466;0.977718353271484 0.0035650625359267 0.00837789662182331;1 0 0;0.998627424240112 0.0486274510622025 0.0486274510622025;0.997254908084869 0.0972549021244049 0.0972549021244049;0.995882332324982 0.145882353186607 0.145882353186607;0.994509816169739 0.19450980424881 0.19450980424881;0.993137240409851 0.243137255311012 0.243137255311012;0.991764724254608 0.291764706373215 0.291764706373215;0.99039214849472 0.340392172336578 0.340392172336578;0.989019632339478 0.38901960849762 0.38901960849762;0.98764705657959 0.437647044658661 0.437647044658661;0.986274480819702 0.486274510622025 0.486274510622025;0.984901964664459 0.534901976585388 0.534901976585388;0.983529388904572 0.583529412746429 0.583529412746429;0.982156872749329 0.632156848907471 0.632156848907471;0.980784296989441 0.680784344673157 0.680784344673157;0.979411780834198 0.729411780834198 0.729411780834198;0.97803920507431 0.778039216995239 0.778039216995239;0.976666688919067 0.826666653156281 0.826666653156281;0.97529411315918 0.875294089317322 0.875294089317322;0.973921597003937 0.923921585083008 0.923921585083008;0.972549021244049 0.972549021244049 0.972549021244049;0.926237165927887 0.926237165927887 0.973856210708618;0.879925310611725 0.879925310611725 0.975163400173187;0.833613455295563 0.833613455295563 0.976470589637756;0.787301599979401 0.787301599979401 0.977777779102325;0.740989744663239 0.740989744663239 0.979084968566895;0.694677889347076 0.694677889347076 0.980392158031464;0.648366034030914 0.648366034030914 0.981699347496033;0.602054178714752 0.602054178714752 0.983006536960602;0.55574232339859 0.55574232339859 0.984313726425171;0.509430468082428 0.509430468082428 0.98562091588974;0.463118582963943 0.463118582963943 0.986928105354309;0.416806727647781 0.416806727647781 0.988235294818878;0.370494872331619 0.370494872331619 0.989542484283447;0.324183017015457 0.324183017015457 0.990849673748016;0.277871161699295 0.277871161699295 0.992156863212585;0.231559291481972 0.231559291481972 0.993464052677155;0.18524743616581 0.18524743616581 0.994771242141724;0.138935580849648 0.138935580849648 0.996078431606293;0.0926237180829048 0.0926237180829048 0.997385621070862;0.0463118590414524 0.0463118590414524 0.998692810535431;0 0 1]);

    

% fig = contourf(U,V,F(U,V),50,'LineStyle','none'); % Contour plot
fig = surf(U, V, F(U,V),'edgealpha', 0); % Surf plot


% Format plot
view(2);
xlabel('RSLR (mm/yr)','fontsize',22);
ylabel('Bay Sediment Flux (m^3/yr)','fontsize',22,'Units', 'Normalized', 'Position', [-.06, 0.5, 0]);
bar = colorbar;
% caxis([-100 50]);
caxis([-1000 1000]); %# HARD WIRED!!
ylabel(bar,'Difference in Width - SG vs No SG','Rotation', 270, 'fontsize', 16, 'Units', 'Normalized', 'Position', [4.5, 0.5, 0]);
set(gca,'xtick',1:96);
set(gca,'xticklabel',min(RSLR):max(RSLR));
set(gca,'ytick',1:96);
set(gca,'yticklabel',min(RivInput):6:max(RivInput)); %# HARD WIRED!
set(gca,'fontsize',18);
title(Title);

% set(gca,'visible','off');


end

